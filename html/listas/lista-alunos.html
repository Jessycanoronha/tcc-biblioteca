<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="utf-8">
  <title> Gerar Lista de Alunos por Turma | Qg da Leitura </title>
  <link rel="stylesheet" href="../../css/style_form.css" media="screen">
  <link rel="stylesheet" href="../../css/print.css" media="print">
</head>
<body>
<div class="interface">
  <a class="btn bt-voltar" href="menu-listas.html"> Menu </a>

  <h1> Gerar lista de alunos por turma: </h1>

    <form class="frm frm-medium form_lista">
      <fieldset id="lista-alunos">
        <legend> Pesquisar </legend>
          <label> Informe o número de uma turma para o sistema e ele irá gerar uma lista de alunos</label>
          <div>
            <input type="number" placeholder="Faça a sua busca" name="turma" size="35" maxlength="15" min="1000" id="turma" value="1001" pattern="/\d\d\d\d/" autofocus>

            <button type="button" class="btn confirm" id="submit"> Gerar Lista </button>
          </div>
      </fieldset>
    </form>

    <div class="resposta">

    </div>
    <script>

    var btn = document.getElementById("submit");

    btn.addEventListener("click", function() {
      // Recuperando os dados dos formulários
      var turma = document.getElementById("turma").value;
      if (turma != "") {
        var butao1 = " <button class='btn bt confirm' type='button' onclick='window.print()'> Imprimir </button> ";
        var butao2 = " <button class='btn filtro' type='button' onclick='voltar()'> Voltar a adicionar </button> ";

        // Fazendo surgir a tela de resposta
        document.getElementsByClassName("resposta")[0].style.display = "block";
        document.getElementsByClassName("frm")[0].style.display = "none";
        // Realizando a requisição ajax
        var http = new XMLHttpRequest();

        http.onreadystatechange = function() {
          if (http.readyState == 4 && http.status == 200) {
            var resposta = http.responseText;
            document.getElementsByClassName("resposta")[0].style.display = "block";
            document.getElementsByClassName("resposta")[0].innerHTML = resposta + butao1 + butao2;
          } else {
            document.getElementsByClassName("resposta")[0].style.display = "block";
            document.getElementsByClassName("resposta")[0].innerHTML = "<p> Carregando...</p>";
          }
        }

        http.open("GET", "http://127.0.0.1/tcc-biblioteca/php/lista/lista-alunos.php?turma=" + turma, true);
        http.send(null);
      }
    });

    function voltar() {
      window.location.reload();
    }
</script>
</div>
</body>
</html>
