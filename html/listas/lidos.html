<!DOCTYPE html>
<html lang="pt-br">
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" href="../../css/style_form.css" media="screen">
		<link rel="stylesheet" href="../../css/print.css" media="print">
		<title> Formulário de livros mais lidos | Qg da Leitura </title>
	</head>
	<body>
	<div class="interface">
		<a class="btn bt-voltar" href="menu-listas.html"> Menu </a>

    <h1> Lista de livros mais lidos</h1>

		<form class="frm frm-medium form_lista">
      <fieldset>
          <legend> Pesquisar </legend>
					<div>
          <label> Exibir os livros mais lidos no período de: </label>
	          <select name="periodo">
              <option value="1"> Dois meses </option>
              <option value="2"> Tres meses </option>
              <option value="3"> Seis meses meses </option>
              <option value="4"> Anual </option>
	          </select>
					</div>
					<div>
						<label for="numero"> N° de registros </label>
						<input type="number" id="numero" name="quantidade" min="10" value="10">
					</div>
          <button type="button" id="submit" class="btn confirm"> Enviar </button>
      </fieldset>
    </form>

		<div class="resposta">

		</div>
		</div>
	<script>
		var btn = document.getElementById("submit");

		// Executando a requisição ajax
		btn.addEventListener("click", function() {
			// Fazendo surgir a tela de resposta
			document.getElementsByClassName("resposta")[0].style.display = "block";
			document.getElementsByClassName("frm")[0].style.display = "none";

			// Recuperando os dados dos formulários
			var select  = document.getElementsByTagName("select")[0].value,
					quantidade = document.getElementById("numero").value,
					div = document.getElementsByClassName("resposta")[0],
					p = "<p> Carregando... </p>";

			var butao1 = " <button class='btn bt confirm' type='button' onclick='window.print()'> Imprimir </button> ";
			var butao2 = " <button class='btn filtro' type='button' onclick='voltar()'> Voltar a adicionar </button> ";

			// Realizando a requisição ajax
			var http = new XMLHttpRequest();

			http.onreadystatechange = function() {
				if (http.readyState == 4 && http.status == 200) {
					var resposta = http.responseText;
					div.style.display = "block";
					div.innerHTML = resposta + butao1 + butao2;
				} else {
					div.style.display = "block";
					div.innerHTML = p;
				}
			}

			http.open("GET", "http://127.0.0.1/tcc-biblioteca/php/lista/lista-lidos.php?quantidade=" + quantidade + "&periodo=" + select, true);
			http.send(null);

		});

		function voltar() {
			window.location.reload();
		}
	</script>
	</body>
</html>
